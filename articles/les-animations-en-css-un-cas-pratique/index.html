<!DOCTYPE html>
<!--[if lte IE 7]> <html class="ie7 no-js" lang="fr"> <![endif]-->
<!--[if IE 8]> <html class="ie8 no-js" lang="fr"> <![endif]-->
<!--[if IE 9]> <html class="ie9 no-js" lang="fr"> <![endif]-->
<html lang="fr" class="no-js">
<head>
  <meta charset="UTF-8">
  <title>Ronan Levesque - Animations en CSS : un cas pratique</title>
  <script>
    document.documentElement.className = document.documentElement.className.replace(/(\s|^)no-js(\s|$)/, '$1js$2');
    if(( navigator.userAgent.match(/(Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini)/g) ? true : false ) == true) {
      document.documentElement.className += ' mobile';
    }
  </script>
  <meta name="description" content="Exemple d'animation d'une bannière grâce à CSS3">
  <meta name="author" content="Ronan Levesque">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/fox.css">
  <link href='http://fonts.googleapis.com/css?family=Merriweather:400italic,400,700%7CMerriweather+Sans:400,300,700' rel='stylesheet' type='text/css'>
  <!--[if (gte IE 6)&(lte IE 8)]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>
<body>
  <header class="header" role="banner">
    <div class="header__left">
      <a href="/" class="logo"><img src="/img/logo-ronan-levesque.svg" alt="Logo Ronan Levesque"></a>
    </div>
    <div class="header__right">
      <button class="mobile-nav" id="open-nav" disabled><img src="/img/icones/icone-menu.svg" alt="Icône menu" class="logo"> Menu</button>
      <button class="mobile-nav mobile-nav--hidden" id="close-nav"><img src="/img/icones/icone-close.svg" alt="Icône menu" class="logo"> Close</button>
    </div>
  </header>

  <nav class="nav" role="navigation">
    <ul class="nav__list">
      <li class="nav__item" id="nav__item-1"><a href="/projets">Projets</a></li>
      <li class="nav__item" id="nav__item-2"><a class="selected" href="/articles">Articles</a></li>
      <li class="nav__item" id="nav__item-3"><a href="/a-propos">A propos</a></li>
      <li class="nav__item" id="nav__item-4"><a href="mailto:ronan.levesque@gmail.com">Contact</a></li>
      <li class="nav__item" id="nav__item-5"></li>
    </ul>
  </nav>
  <div class="big-title">
    <div class="big-title__center">
      <p class="big-title__small">Article</p>
      <h1 class="big-title__title">Animations en CSS : un cas pratique</h1>
      <p class="big-title__subtitle">Publié le <time>07.05.13</time> - <span class="caps">CSS, Tutoriels</span></p>
    </div>
  </div>
  <div class="wrapper">
    <main class="main" role="main">
      <article class="article">
        <p>J&#39;avais posté il y a quelques temps un bref <a href="http://ronanlevesque.fr/les-animations-en-css/">tutoriel</a> sur les animations en CSS. Depuis je n&#39;avais pas vraiment creusé la question, mais en refaisant le site récemment j&#39;ai décidé d&#39;ajouter un peu de vie dans la bannière, en faisant bouger quelques-uns des éléments du paysage (nuage, fumée de l&#39;usine, drapeau et montgolfière). L&#39;idée ici est de montrer comment ça fonctionne, concrètement.</p>

<p class="credits">Mise à jour (04/06/2013) : j'ai changé le header de mon site depuis, mais j'ai laissé un <a href="/old/old5/page.html">exemple</a> en ligne.</p>

<p class="credits">Attention, comme pour le tuto précédent, dans les exemples qui suivent je n'ai rien préfixé pour plus de simplicité.</p>

<h2>Les animations en détail</h2>

<h3>Les nuages</h3>

<p>La première des animations sur laquelle j&#39;ai travaillé était de faire bouger les nuages comme si ils étaient mûs par un vent d&#39;ouest (de gauche). Il existe deux méthodes pour faire bouger des éléments :</p>

<ol>
<li>Avec les propriétés <code>translate()</code>, <code>translateX()</code> et <code>translateY()</code></li>
<li>En utilisant <code>position:absolute</code> et <code>left</code>, <code>right</code>, <code>top</code>, <code>bottom</code>.</li>
</ol>

<p>Il semblerait que la première solution soit celle à privilégier pour des <a href="http://paulirish.com/2012/why-moving-elements-with-translate-is-better-than-posabs-topleft/">soucis de performance <sup>EN</sup></a>. Le hic, c&#39;est que <code>translate()</code> ne bouge l&#39;élément que par rapport à sa position originale. Ça me posait un souci car dans ce cas, impossible d&#39;avoir un contrôle précis de la position de l&#39;élément par rapport à la fenêtre du navigateur. J&#39;ai donc eu recours à la deuxième solution, en utilisant le <code>@keyframes</code> suivant :</p>

<pre class="pre-css prettyprint">@keyframes nuage1 {
  from {left: -200px;}
  to {left: 100%;}
}</pre>

<p>De cette façon, mon nuage apparaîtra à chaque fois à 200px du bord gauche de ma fenêtre et se repositionnera bien après être arrivé à 100%. J&#39;ai ensuite attribué plusieurs vitesses à chacun de mes nuages pour leur donner un effet plus réaliste, par exemple :</p>

<pre class="pre-css prettyprint">.nuage1 {
  animation: nuage1 32s linear infinite;
}</pre>

<p>Les animations des nuages saccadent légèrement sur Chrome, mais sur Firefox et IE10 c&#39;est plutôt fluide, d&#39;après ce que j&#39;ai testé.</p>

<p class="credits">Mise à jour (11/05/2013) : en testant le site sur iPad je me suis rendu compte que l'animation ne marchait pas du tout : les nuages restent collés à 100% de leur position, sans bouger. Je creuserai la question plus tard, en attendant j'ai désactivé leurs animations.</p>

<h3>La montgolfière</h3>

<p>Là, contrairement aux nuages, la montgolfière ne bouge que par rapport à sa position d&#39;origine, l&#39;idée étant de lui donner un léger effet &quot;flottant&quot; de haut en bas. J&#39;ai donc pu utiliser <code>translateY()</code> pour arriver à ce résultat :</p>

<pre class="pre-css prettyprint">@keyframes montgolfiere {
  50% {transform: translateY(10px);}
}</pre>

<p>A noter qu&#39;un simple ligne revient ici au même résultat que si l&#39;on avait défini trois étapes à 0, 50 et 100% de notre <code>@keyframes</code>, l&#39;idée étant de faire revenir l&#39;élément à sa position de départ.</p>

<h3>La fumée</h3>

<p>Ici, même principe que pour l&#39;animation de la montgolfière : la fumée se déplacera à chaque fois par rapport à sa position initiale. J&#39;ai également ajouté un effet d&#39;opacité, pour la rendre un peu plus réaliste. Le code est le suivant :</p>

<pre class="pre-css prettyprint">@keyframes fumee {
  from {transform: translate(0px, 0px); opacity: 0;}
  50% {transform: translate(7px, -7px); opacity: 1;}
  to {transform: translate(20px, -20px); opacity: 0;}
}</pre>

<p>Arrivée à 100% de l&#39;animation, la fumée repartira de son point de départ.</p>

<h3>Le drapeau</h3>

<p>Pour donner l&#39;impression que le drapeau flotte au vent, c&#39;est plutôt simple : il suffit de changer sa <code>width</code> dans le temps, de la manière suivante :</p>

<pre class="pre-css prettyprint">@keyframes flag {
  50% {width: 4px;}
}</pre>

<p>Le drapeau passera de 7 à 4px en boucle, donnant ainsi l&#39;impression qu&#39;il bouge.</p>

<h2>Problèmes rencontrés</h2>

<p>Les animations n&#39;ont rien de sorcier, elles sont simples à utiliser une fois qu&#39;on a saisi le concept de départ. J&#39;ai juste rencontré deux problèmes lors de leur conception...</p>

<p>Tout d&#39;abord, sur Firefox et IE10, les animations de la fumée et de la montgolfière sont légèrement saccadées, contrairement à Chrome. En fait ce dernier semble lisser les animations d&#39;un pixel à un autre, ce qui rend l&#39;image légèrement floue mais donne un meilleur rendu final. Les deux autres navigateurs déplacent l&#39;image pixel par pixel, le rendu est légèrement moins esthétique à mon goût... Mais à ma connaissance on ne peut malheureusement pas y faire grand chose.</p>

<p>Ensuite, après avoir bouclé mes animations, j&#39;ai testé tout ça sur Firefox (niquel), puis sur Chrome (niquel), et arrivé sur IE10 : rien ne se passe. Un peu bizarre, IE10 gère normalement très bien les animations, et ce sans avoir besoin de les préfixer. Après avoir vérifié et revérifié la syntaxe, fait quelques tests supplémentaires, et m&#39;être arraché un ou deux cheveux, j&#39;ai trouvé la solution : en fait j&#39;ai créé deux feuilles de styles pour mon site, style.css et expand.css. La deuxième utilise un <code>media</code> avec une <code>(min-width: 35em)</code>. Mes <code>@keyframes</code> étaient situées dans expand.css : dès que je les ai déplacés dans style.css, les animations se sont remises à marcher. Je n&#39;ai aucune idée de la raison pour laquelle IE10 bloque les animations lorsque celles-ci sont contenues dans une feuille de style d&#39;une taille spécifique, mais au moins je sais comment corriger ça maintenant :)</p>

<h2>Fallbacks possibles</h2>

<p>J&#39;ai utilisé un fallback simple pour que le rendu reste agréable sur les navigateurs ne supportant pas les <code>@keyframes</code> : les nuages, fumée et montgolfière sont définis dès le départ en position absolue. Ils seront simplement fixes.</p>

        <p class="article__share">
          Partagez cet article :
          <span class="article__social-icons">
            <a href="http://twitter.com/home?status=Animations en CSS : un cas pratique http://ronanlevesque.fr/articles/les-animations-en-css-un-cas-pratique" class="share-twitter"><svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"><path fill="#bbb" d="M462 128.223c-15.158 6.724-31.45 11.27-48.547 13.31 17.45-10.46 30.854-27.025 37.164-46.764-16.333 9.686-34.422 16.72-53.676 20.51-15.417-16.428-37.385-26.69-61.697-26.69-54.56 0-94.668 50.915-82.337 103.786-70.25-3.524-132.534-37.177-174.223-88.314-22.142 37.983-11.485 87.69 26.158 112.85-13.853-.438-26.89-4.24-38.284-10.574-.917 39.162 27.146 75.78 67.795 83.95-11.895 3.236-24.925 3.977-38.17 1.446 10.755 33.58 41.973 58.018 78.96 58.7C139.605 378.28 94.847 390.72 50 385.435c37.406 23.982 81.837 37.977 129.57 37.977 156.933 0 245.596-132.55 240.252-251.435 16.517-11.917 30.846-26.804 42.178-43.755z" /></svg> Twitter</a><!--
            --><a href="http://www.facebook.com/sharer.php?s=100&amp;p[url]=http://ronanlevesque.fr/articles/les-animations-en-css-un-cas-pratique&amp;p[title]=Animations en CSS : un cas pratique" class="share-fb"><svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"><path fill="#bbb" d="M204.067 184.692h-43.144v70.426h43.144V462h82.965V254.238h57.882l6.162-69.546h-64.044v-39.615c0-16.398 3.302-22.89 19.147-22.89h44.895V50h-57.44c-61.735 0-89.568 27.18-89.568 79.23v55.462z" /></svg> Facebook</a><!--
            --><a href="https://plus.google.com/share?url=http://ronanlevesque.fr/articles/les-animations-en-css-un-cas-pratique" class="share-gplus"><svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"><path fill="#bbb" d="M462 141.347h-54.62v54.622h-27.312v-54.623h-54.622v-27.31h54.622v-54.62h27.31v54.62H462v27.31zM307.583 367.26c0 40.943-37.384 90.787-131.434 90.787-68.785 0-126.15-29.668-126.15-79.57 0-38.513 24.383-88.51 138.323-88.51-16.922-13.792-21.075-33.077-10.733-53.96-66.714 0-100.88-39.22-100.88-89.022 0-48.73 36.243-93.032 110.15-93.032h118.4L278.8 81.723h-31.08c21.926 12.562 33.587 38.433 33.587 66.95 0 26.174-14.414 47.374-34.984 63.278-36.503 28.223-27.158 43.98 11.087 71.873 37.708 28.25 50.17 50.06 50.17 83.437zm-73.845-216.807c-5.506-41.905-32.806-76.284-64.704-77.243-31.91-.95-53.31 31.12-47.798 73.035 5.51 41.905 35.834 71.178 67.75 72.14 31.896.948 50.256-26.022 44.752-67.932zm32.893 221.01c0-34.466-31.44-67.317-84.19-67.317-47.543-.523-87.833 30.042-87.833 65.47 0 36.155 34.335 66.25 81.88 66.25 60.78 0 90.144-28.25 90.144-64.403z" /></svg> Google+</a>
          </span>
        </p>
      </article>
    </main>
  </div>
  <footer class="footer" role="contentinfo">
    <div class="footer__inner">
      <p>Contenu (c) Ronan Levesque 2012-2014</p>
      <ul class="footer__social">
        <li><a href="https://twitter.com/ronanlevesque"><img src="/img/icones/icone-footer-twitter.svg" alt="Icône Twitter"></a></li><!--
        --><li><a href="https://github.com/ronanlevesque"><img src="/img/icones/icone-footer-github.svg" alt=""></a></li><!--
        --><li><a href="mailto:ronan.levesque@gmail.com"><img src="/img/icones/icone-footer-mail.svg" alt=""></a></li><!--
        --><li><a href="https://plus.google.com/117241456277987276836"><img src="/img/icones/icone-footer-google-plus.svg" alt=""></a></li><!--
        --><li><a href="skype:ronan.levesque?call"><img src="/img/icones/icone-footer-skype.svg" alt=""></a></li><!--
        --><li><a href="http://fr.linkedin.com/in/ronanlevesque"><img src="/img/icones/icone-footer-linkedin.svg" alt=""></a></li>
      </ul>
    </div>
  </footer>
<!--   <div class="loader" id="loader">
  <img class="spinner" id="spinner" src="/img/goutte.svg" alt="Goutte">
</div> -->
  <div class="ie-warning">
    <p>Désolé, ce site ne supporte plus les navigateurs obsolètes. Essayez-en un <a href="http://browsehappy.com/">plus récent</a> :)</p>
    <img src="/img/logo-ie.jpg" alt="Logo IE">
  </div>
  <script src="/js/main.js"></script>
  <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?autoload=true&amp;skin=desert"></script>
  <script>
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-29762874-1']);
    _gaq.push(['_trackPageview']);

    (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</body>
</html>

