<!DOCTYPE html>
<!--[if lte IE 7]> <html class="ie7 no-js" lang="fr"> <![endif]-->
<!--[if IE 8]> <html class="ie8 no-js" lang="fr"> <![endif]-->
<!--[if IE 9]> <html class="ie9 no-js" lang="fr"> <![endif]-->
<html lang="fr" class="no-js">
<head>
  <meta charset="UTF-8">
  <title>Ronan Levesque - Animations en CSS : un cas pratique</title>
  <meta name="description" content="Exemple d'animation d'une bannière grâce à CSS3">
  <meta name="author" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Ronan Levesque" />
  <meta property="og:title" content="Animations en CSS : un cas pratique" />
  <meta property="og:description" content="Exemple d'animation d'une bannière grâce à CSS3">
  <meta property="og:url" content="http://ronanlevesque.fr/articles/les-animations-en-css-un-cas-pratique" />
  <link rel="dns-prefetch" href="//fonts.googleapis.com" />
  <link rel="dns-prefetch" href="//www.google-analytics.com" />
  <link rel="stylesheet" href="/css/fox.css?v=150113144233">
  <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic|Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <script>document.documentElement.className = document.documentElement.className.replace(/(\s|^)no-js(\s|$)/, '$1js$2');</script>
  <!--[if (gte IE 6)&(lte IE 8)]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>
<body>

  <header class="header" role="banner">
    <div class="header__inner">
      <div class="logo">
        <a href="/">
          <svg width="450" height="450" viewBox="0 0 450 450" xmlns="http://www.w3.org/2000/svg"><g fill="none"><path d="M57.217 85.967c22.26-7.77 44.397-15.496 66.538-23.22 32.036-11.18 64.076-22.343 96.103-33.55 2.748-.96 5.328-1.35 8.23-.334 53.696 18.79 107.417 37.507 161.13 56.25.455.16.857.475 1.52.85v274.775c-47.212 16.584-94.385 33.156-141.56 49.72-5.798 2.037-11.665 3.89-17.4 6.085-4.913 1.88-9.596 1.806-14.556.06-52.024-18.325-104.08-36.556-156.128-54.813-1.232-.433-2.466-.862-3.875-1.354-.003-91.33-.003-182.604-.003-274.47z" fill="#fff"/><path d="M284.11 148.303l88.557-29.98v189.723L233.31 355.314V165.45c8.796-2.954 17.552-5.897 27.026-9.08v164.173l87.363-30.646v-21.234L284.11 290.9V148.304z" fill="#151515" class="darker" /><path d="M214.683 355.31l-26.395-8.96V184.793l-87.056-30.465v95.164c6.35 3.312 14.003 4.2 20.614 8.462l-21.505 33.82c7.777 2.74 15.096 5.32 22.81 8.042l22.093-34.545c6.818 2.39 13.338 4.68 19.882 6.975v66.195l-89.81-30.362V118.334l139.368 47.12V355.31z" fill="#353535" class="normal" /><path d="M77.007 99.593l-.165-1.105 147.543-51.462c49.125 17.13 98.31 34.284 147.495 51.436l.006 1.088-147.523 51.41L77.007 99.594z" fill="#454545" class="lighter" /><path d="M218.732 399.713c-47.732-16.75-95.45-33.537-143.433-50.41v-23.82c1.73-1.083 3.16.34 4.56.83 47.603 16.647 95.176 33.375 142.756 50.086.78.272 1.584.466 2.377.697 1.188.75 1.894 1.81 2.002 3.22.44 5.75.453 11.5-.007 17.25-.114 1.43-.968 2.4-1.99 3.276-2.274.67-4.267-.428-6.266-1.13z" fill="#353535" class="normal" /><path d="M224.994 377.097c22.48-8 44.944-16.04 67.443-23.987 25.477-9 50.982-17.92 76.48-26.86 1.217-.425 2.483-.708 3.913-1.11v24.396c-29.733 10.458-59.41 20.897-89.086 31.332-17.827 6.27-35.647 12.556-53.5 18.755-1.672.58-3.292 1.715-5.245 1.22-.003-7.915-.004-15.83-.006-23.746z" fill="#151515" class="darker" /><path d="M165.206 198.815v51.347l-43.232-15.134v-51.38c14.69 5.152 28.923 10.146 43.232 15.167z" fill="#353535" class="normal" /></g></svg>
        </a>
      </div>
      <div class="mobile-nav">
        <button class="mobile-nav__open">
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="512px" height="512px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path id="menu-2-icon" fill="#fff" d="M123.027,413.5H50v-65h73.027V413.5z M123.027,223.5H50v65h73.027V223.5z M123.027,98.5H50v65h73.027V98.5z M168.027,98.5v65H462v-65H168.027z M168.027,288.5H462v-65H168.027V288.5z M168.027,413.5H462v-65H168.027V413.5z"/></svg>
          Menu
        </button>
        <button class="mobile-nav__close">
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="512px" height="512px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><polygon id="x-mark-icon" fill="#fff" points="438.393,374.595 319.757,255.977 438.378,137.348 374.595,73.607 255.995,192.225 137.375,73.622 73.607,137.352 192.246,255.983 73.622,374.625 137.352,438.393 256.002,319.734 374.652,438.378 "/></svg>
          Close
        </button>
      </div>
    </div>
    <nav class="nav" role="navigation">
      
      <ol>
        <li><a href="/projets" ><span>1 .</span> Projets</a></li><!--
        --><li><a href="/articles" class='selected'><span>2 .</span> Articles</a></li><!--
        --><li><a href="/a-propos" ><span>3 .</span> A propos</a></li>
      </ol>
    </nav>
  </header>

  <main role="main" class="main">
    <div class="page-header">
      <h1 class="page-header__title">Animations en CSS : un cas pratique</h1>
    </div>
    <article class="article">
      <p>J&#39;avais posté il y a quelques temps un bref <a href="http://ronanlevesque.fr/les-animations-en-css/">tutoriel</a> sur les animations en CSS. Depuis je n&#39;avais pas vraiment creusé la question, mais en refaisant le site récemment j&#39;ai décidé d&#39;ajouter un peu de vie dans la bannière, en faisant bouger quelques-uns des éléments du paysage (nuage, fumée de l&#39;usine, drapeau et montgolfière). L&#39;idée ici est de montrer comment ça fonctionne, concrètement.</p>

<p>Attention, comme pour le tuto précédent, dans les exemples qui suivent je n&#39;ai rien préfixé pour plus de simplicité.</p>

<p class="info">Mise à jour (04/06/2013) : j'ai changé le header de mon site depuis, mais j'ai laissé un <a href="/old/old5/page.html">exemple</a> en ligne.</p>

<h2>Les animations en détail</h2>

<h3>Les nuages</h3>

<p>La première des animations sur laquelle j&#39;ai travaillé était de faire bouger les nuages comme si ils étaient mûs par un vent d&#39;ouest (de gauche). Il existe deux méthodes pour faire bouger des éléments :</p>

<ol>
<li>Avec les propriétés <code>translate()</code>, <code>translateX()</code> et <code>translateY()</code></li>
<li>En utilisant <code>position:absolute</code> et <code>left</code>, <code>right</code>, <code>top</code>, <code>bottom</code>.</li>
</ol>

<p>Il semblerait que la première solution soit celle à privilégier pour des <a href="http://paulirish.com/2012/why-moving-elements-with-translate-is-better-than-posabs-topleft/">soucis de performance <sup>EN</sup></a>. Le hic, c&#39;est que <code>translate()</code> ne bouge l&#39;élément que par rapport à sa position originale. Ça me posait un souci car dans ce cas, impossible d&#39;avoir un contrôle précis de la position de l&#39;élément par rapport à la fenêtre du navigateur. J&#39;ai donc eu recours à la deuxième solution, en utilisant le <code>@keyframes</code> suivant :</p>

<pre class="pre-css prettyprint">@keyframes nuage1 {
  from {left: -200px;}
  to {left: 100%;}
}</pre>

<p>De cette façon, mon nuage apparaîtra à chaque fois à 200px du bord gauche de ma fenêtre et se repositionnera bien après être arrivé à 100%. J&#39;ai ensuite attribué plusieurs vitesses à chacun de mes nuages pour leur donner un effet plus réaliste, par exemple :</p>

<pre class="pre-css prettyprint">.nuage1 {
  animation: nuage1 32s linear infinite;
}</pre>

<p>Les animations des nuages saccadent légèrement sur Chrome, mais sur Firefox et IE10 c&#39;est plutôt fluide, d&#39;après ce que j&#39;ai testé.</p>

<p class="info">Mise à jour (11/05/2013) : en testant le site sur iPad je me suis rendu compte que l'animation ne marchait pas du tout : les nuages restent collés à 100% de leur position, sans bouger. Je creuserai la question plus tard, en attendant j'ai désactivé leurs animations.</p>

<h3>La montgolfière</h3>

<p>Là, contrairement aux nuages, la montgolfière ne bouge que par rapport à sa position d&#39;origine, l&#39;idée étant de lui donner un léger effet &quot;flottant&quot; de haut en bas. J&#39;ai donc pu utiliser <code>translateY()</code> pour arriver à ce résultat :</p>

<pre class="pre-css prettyprint">@keyframes montgolfiere {
  50% {transform: translateY(10px);}
}</pre>

<p>A noter qu&#39;un simple ligne revient ici au même résultat que si l&#39;on avait défini trois étapes à 0, 50 et 100% de notre <code>@keyframes</code>, l&#39;idée étant de faire revenir l&#39;élément à sa position de départ.</p>

<h3>La fumée</h3>

<p>Ici, même principe que pour l&#39;animation de la montgolfière : la fumée se déplacera à chaque fois par rapport à sa position initiale. J&#39;ai également ajouté un effet d&#39;opacité, pour la rendre un peu plus réaliste. Le code est le suivant :</p>

<pre class="pre-css prettyprint">@keyframes fumee {
  from {transform: translate(0px, 0px); opacity: 0;}
  50% {transform: translate(7px, -7px); opacity: 1;}
  to {transform: translate(20px, -20px); opacity: 0;}
}</pre>

<p>Arrivée à 100% de l&#39;animation, la fumée repartira de son point de départ.</p>

<h3>Le drapeau</h3>

<p>Pour donner l&#39;impression que le drapeau flotte au vent, c&#39;est plutôt simple : il suffit de changer sa <code>width</code> dans le temps, de la manière suivante :</p>

<pre class="pre-css prettyprint">@keyframes flag {
  50% {width: 4px;}
}</pre>

<p>Le drapeau passera de 7 à 4px en boucle, donnant ainsi l&#39;impression qu&#39;il bouge.</p>

<h2>Problèmes rencontrés</h2>

<p>Les animations n&#39;ont rien de sorcier, elles sont simples à utiliser une fois qu&#39;on a saisi le concept de départ. J&#39;ai juste rencontré deux problèmes lors de leur conception...</p>

<p>Tout d&#39;abord, sur Firefox et IE10, les animations de la fumée et de la montgolfière sont légèrement saccadées, contrairement à Chrome. En fait ce dernier semble lisser les animations d&#39;un pixel à un autre, ce qui rend l&#39;image légèrement floue mais donne un meilleur rendu final. Les deux autres navigateurs déplacent l&#39;image pixel par pixel, le rendu est légèrement moins esthétique à mon goût... Mais à ma connaissance on ne peut malheureusement pas y faire grand chose.</p>

<p>Ensuite, après avoir bouclé mes animations, j&#39;ai testé tout ça sur Firefox (niquel), puis sur Chrome (niquel), et arrivé sur IE10 : rien ne se passe. Un peu bizarre, IE10 gère normalement très bien les animations, et ce sans avoir besoin de les préfixer. Après avoir vérifié et revérifié la syntaxe, fait quelques tests supplémentaires, et m&#39;être arraché un ou deux cheveux, j&#39;ai trouvé la solution : en fait j&#39;ai créé deux feuilles de styles pour mon site, style.css et expand.css. La deuxième utilise un <code>media</code> avec une <code>(min-width: 35em)</code>. Mes <code>@keyframes</code> étaient situées dans expand.css : dès que je les ai déplacés dans style.css, les animations se sont remises à marcher. Je n&#39;ai aucune idée de la raison pour laquelle IE10 bloque les animations lorsque celles-ci sont contenues dans une feuille de style d&#39;une taille spécifique, mais au moins je sais comment corriger ça maintenant :)</p>

<h2>Fallbacks possibles</h2>

<p>J&#39;ai utilisé un fallback simple pour que le rendu reste agréable sur les navigateurs ne supportant pas les <code>@keyframes</code> : les nuages, fumée et montgolfière sont définis dès le départ en position absolue. Ils seront simplement fixes.</p>

    </article>
    
    <a class="next-post article-nav" href="/articles/friday-links-2">
      <span>Friday Links #2</span>
    </a>
    
    
    <a class="previous-post article-nav" href="/articles/friday-links-1">
      <span>Friday Links #1</span>
    </a>
    
    <div class="article-footer">
      <p class="article-footer__txt">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           width="512px" height="512px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">
        <path class="normal" id="pen-icon" d="M72.819,429.273l14.593,14.593l-15.117,15.11c-4.027,4.031-10.559,4.031-14.588,0.003
          c-4.031-4.03-4.031-10.562,0-14.591L72.819,429.273z M354.941,57.21c-9.784-9.785-25.392-9.526-35.178,0.262l-99.539,99.536
          c-9.785,9.788-10.044,25.392-0.258,35.177L354.941,57.21z M199.832,249.627l-58.925,58.925
          c-30.745,30.745-46.211,60.295-60.268,101.438l26.058,26.058c41.143-14.06,70.689-29.523,101.434-60.264l58.93-58.929
          L199.832,249.627z M441.451,75.232c-21.154-21.154-55.454-21.154-76.608,0L216.368,223.708l76.608,76.609L441.45,151.841
          C462.605,130.685,462.605,96.387,441.451,75.232z"/>
        </svg>
        Article publié le 07.05.2013 dans css, tutoriels.
      </p>
    </div>
  </main>
  <footer class="footer" role="contentinfo">
    <p class="footer__left">&copy; Ronan Levesque 2012 - 2015</p>
    <ul class="footer__right">
      <li><a href="/a-propos">A propos</a></li><!--
      --><li><a href="mailto:ronan.levesque@gmail.com">Me contacter</a></li>
    </ul>
  </footer>
  <!--[if IE 9]> <script src="/js/ie/matchMedia.js"></script> <![endif]-->
  <script src="/js/main.js?v=150113144233"></script>
  <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?autoload=true&amp;skin=desert"></script>
</body>
</html>

