<!DOCTYPE html>
<html lang="fr" class="no-js">

<head>
  <meta charset="UTF-8" />
  <title>Ronan Levesque &ndash; Animations en CSS&nbsp;: un cas pratique</title>
  <meta name="description" content="Exemple d'animation d'une bannière grâce à CSS3" />
  <meta name="author" content="Ronan Levesque" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Ronan Levesque" />
  <meta property="og:title" content="Animations en CSS&nbsp;: un cas pratique" />
  <meta property="og:description" content="Exemple d'animation d'une bannière grâce à CSS3" />
  <meta property="og:url" content="http://ronanlevesque.fr/articles/les-animations-en-css-un-cas-pratique/" />
  <link rel="dns-prefetch" href="//www.google-analytics.com" />
  <link rel="dns-prefetch" href="//fonts.googleapis.com" />
  <link href="/assets/css/styles-1e81365b327cf19aba65cbee598fefd5.css" rel="stylesheet" />
  <link href='https://fonts.googleapis.com/css?family=PT+Mono%7CPT+Sans:700%7CPT+Serif:400,400italic,700' rel='stylesheet' type='text/css' />
  <link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon-180x180.png" />
  <link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="/favicons/favicon-194x194.png" sizes="194x194" />
  <link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/png" href="/favicons/android-chrome-192x192.png" sizes="192x192" />
  <link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16" />
  <link rel="manifest" href="/favicons/manifest.json" />
  <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5" />
  <link rel="shortcut icon" href="/favicons/favicon.ico" />
  <meta name="msapplication-TileColor" content="#343838" />
  <meta name="msapplication-TileImage" content="/favicons/mstile-144x144.png" />
  <meta name="msapplication-config" content="/favicons/browserconfig.xml" />
  <meta name="theme-color" content="#ffffff" />
  <script>
    document.documentElement.className = document.documentElement.className.replace(/(\s|^)no-js(\s|$)/, '$1js$2');
    if (localStorage.getItem('fontsLoaded')) { document.documentElement.className += ' fonts-loaded'; }
  </script>
</head>


<body id="top">



  <div class="js-content">
    <div class="wrapper">
        <header class="mainHeader">
    <div class="mainHeader-logo">
      <a href="/">
        <svg class="logo -header" width="136" height="114" viewBox="0 0 136 114" xmlns="http://www.w3.org/2000/svg"><title>Shape</title><path d="M.206 113.784V87.542h42.16V.925c14.965 0 29.277-.22 43.578.102 6.272.14 12.693.71 18.745 2.264 16.98 4.356 25.74 17.026 24.565 34.44-.894 13.243-7.428 21.372-23.02 28.047l29.19 48.008H102.98c-7.978-14.616-16.098-29.49-24.266-44.458h-8.694v44.458H.206zm69.767-65.03c8.372.24 16.34.83 24.032-1.815 5.438-1.87 8.124-5.945 7.958-11.332-.156-5.046-3.123-8.854-8.62-10.223-7.636-1.9-15.405-1.27-23.37-1.063v24.43z" fill="#e3b932" fill-rule="evenodd"/></svg>
        <p class="mainHeader-title">Ronan Levesque</p>
      </a>
    </div>
    <div class="mainHeader-nav">
      <nav class="mainNav -header">
          <ul class="mainNav-list">
            
            <li class="mainNav-item"><a href="/projets/" class="mainNav-link">Projets</a></li>
            <li class="mainNav-item"><a href="/articles/" class="mainNav-link selected">Articles</a></li>
            <li class="mainNav-item"><a href="/a-propos/" class="mainNav-link">A propos</a></li>
          </ul>
      </nav>
    </div>
  </header>

      
      <article class="article">
      
        <header class="article-header">
          <p class="article-date">07 mai 2013</p>
          <h1 class="article-title">Animations en CSS&nbsp;: un cas pratique</h1>
        </header>
        
        <div class="article-content">
        
          <p>J’avais posté il y a quelques temps un bref <a href="http://ronanlevesque.fr/les-animations-en-css/">tutoriel</a> sur les animations en CSS. Depuis je n’avais pas vraiment creusé la question, mais en refaisant le site récemment j’ai décidé d’ajouter un peu de vie dans la bannière, en faisant bouger quelques-uns des éléments du paysage (nuage, fumée de l’usine, drapeau et montgolfière). L’idée ici est de montrer comment ça fonctionne, concrètement.</p>

<hr />

<p>Attention, comme pour le tuto précédent, dans les exemples qui suivent je n’ai rien préfixé pour plus de simplicité.</p>

<p class="info">Mise à jour (04/06/2013)&nbsp;: j'ai changé le header de mon site depuis, mais j'ai laissé un <a href="/old/old5/page.html">exemple</a> en ligne.</p>

<h2>Les animations en détail</h2>

<h3>Les nuages</h3>

<p>La première des animations sur laquelle j’ai travaillé était de faire bouger les nuages comme si ils étaient mûs par un vent d’ouest (de gauche). Il existe deux méthodes pour faire bouger des éléments :</p>

<ol>
<li>Avec les propriétés <code>translate()</code>, <code>translateX()</code> et <code>translateY()</code></li>
<li>En utilisant <code>position:absolute</code> et <code>left</code>, <code>right</code>, <code>top</code>, <code>bottom</code>.</li>
</ol>

<p>Il semblerait que la première solution soit celle à privilégier pour des <a href="http://paulirish.com/2012/why-moving-elements-with-translate-is-better-than-posabs-topleft/">soucis de performance <sup>EN</sup></a>. Le hic, c’est que <code>translate()</code> ne bouge l’élément que par rapport à sa position originale. Ça me posait un souci car dans ce cas, impossible d’avoir un contrôle précis de la position de l’élément par rapport à la fenêtre du navigateur. J’ai donc eu recours à la deuxième solution, en utilisant le <code>@keyframes</code> suivant :</p>

<pre><code class="css">@keyframes nuage1 {
  from {left: -200px;}
  to {left: 100%;}
}</code></pre>

<p>De cette façon, mon nuage apparaîtra à chaque fois à 200px du bord gauche de ma fenêtre et se repositionnera bien après être arrivé à 100%. J’ai ensuite attribué plusieurs vitesses à chacun de mes nuages pour leur donner un effet plus réaliste, par exemple :</p>

<pre><code class="css">.nuage1 {
  animation: nuage1 32s linear infinite;
}</code></pre>

<p>Les animations des nuages saccadent légèrement sur Chrome, mais sur Firefox et IE10 c’est plutôt fluide, d’après ce que j’ai testé.</p>

<p class="info">Mise à jour (11/05/2013)&nbsp;: en testant le site sur iPad je me suis rendu compte que l'animation ne marchait pas du tout&nbsp;: les nuages restent collés à 100% de leur position, sans bouger. Je creuserai la question plus tard, en attendant j'ai désactivé leurs animations.</p>

<h3>La montgolfière</h3>

<p>Là, contrairement aux nuages, la montgolfière ne bouge que par rapport à sa position d’origine, l’idée étant de lui donner un léger effet “flottant” de haut en bas. J’ai donc pu utiliser <code>translateY()</code> pour arriver à ce résultat :</p>

<pre><code class="css">@keyframes montgolfiere {
  50% {transform: translateY(10px);}
}</code></pre>

<p>A noter qu’un simple ligne revient ici au même résultat que si l’on avait défini trois étapes à 0, 50 et 100% de notre <code>@keyframes</code>, l’idée étant de faire revenir l’élément à sa position de départ.</p>

<h3>La fumée</h3>

<p>Ici, même principe que pour l’animation de la montgolfière : la fumée se déplacera à chaque fois par rapport à sa position initiale. J’ai également ajouté un effet d’opacité, pour la rendre un peu plus réaliste. Le code est le suivant :</p>

<pre><code class="css">@keyframes fumee {
  from {transform: translate(0px, 0px); opacity: 0;}
  50% {transform: translate(7px, -7px); opacity: 1;}
  to {transform: translate(20px, -20px); opacity: 0;}
}</code></pre>

<p>Arrivée à 100% de l’animation, la fumée repartira de son point de départ.</p>

<h3>Le drapeau</h3>

<p>Pour donner l’impression que le drapeau flotte au vent, c’est plutôt simple : il suffit de changer sa <code>width</code> dans le temps, de la manière suivante :</p>

<pre><code class="css">@keyframes flag {
  50% {width: 4px;}
}</code></pre>

<p>Le drapeau passera de 7 à 4px en boucle, donnant ainsi l’impression qu’il bouge.</p>

<h2>Problèmes rencontrés</h2>

<p>Les animations n’ont rien de sorcier, elles sont simples à utiliser une fois qu’on a saisi le concept de départ. J’ai juste rencontré deux problèmes lors de leur conception…</p>

<p>Tout d’abord, sur Firefox et IE10, les animations de la fumée et de la montgolfière sont légèrement saccadées, contrairement à Chrome. En fait ce dernier semble lisser les animations d’un pixel à un autre, ce qui rend l’image légèrement floue mais donne un meilleur rendu final. Les deux autres navigateurs déplacent l’image pixel par pixel, le rendu est légèrement moins esthétique à mon goût… Mais à ma connaissance on ne peut malheureusement pas y faire grand chose.</p>

<p>Ensuite, après avoir bouclé mes animations, j’ai testé tout ça sur Firefox (niquel), puis sur Chrome (niquel), et arrivé sur IE10 : rien ne se passe. Un peu bizarre, IE10 gère normalement très bien les animations, et ce sans avoir besoin de les préfixer. Après avoir vérifié et revérifié la syntaxe, fait quelques tests supplémentaires, et m’être arraché un ou deux cheveux, j’ai trouvé la solution : en fait j’ai créé deux feuilles de styles pour mon site, style.css et expand.css. La deuxième utilise un <code>media</code> avec une <code>(min-width: 35em)</code>. Mes <code>@keyframes</code> étaient situées dans expand.css : dès que je les ai déplacés dans style.css, les animations se sont remises à marcher. Je n’ai aucune idée de la raison pour laquelle IE10 bloque les animations lorsque celles-ci sont contenues dans une feuille de style d’une taille spécifique, mais au moins je sais comment corriger ça maintenant :)</p>

<h2>Fallbacks possibles</h2>

<p>J’ai utilisé un fallback simple pour que le rendu reste agréable sur les navigateurs ne supportant pas les <code>@keyframes</code> : les nuages, fumée et montgolfière sont définis dès le départ en position absolue. Ils seront simplement fixes.</p>

        </div>
      </article>
        
  <footer class="mainFooter">
  
    <a href="#top" data-scroll class="js-back-to-top flip-container">
      <div class="flip">
        <svg class="logo -footer front" xmlns="http://www.w3.org/2000/svg" width="200.003" height="200.003" viewBox="0 0 200.003 200.003"><path fill="#e3b932" d="M0 200.003V0h200.003v200.003H0zm32.206-43.22h69.816v-44.457h8.694c8.168 14.967 16.288 29.842 24.266 44.458h32.442l-29.188-48.008c15.59-6.675 22.125-14.804 23.02-28.047 1.174-17.415-7.585-30.084-24.567-34.44-6.053-1.553-12.474-2.124-18.746-2.264-14.3-.322-28.613-.102-43.577-.102v86.617h-42.16v26.244z"/><path fill-rule="evenodd" clip-rule="evenodd" fill="#fff" d="M32.206 156.784v-26.242h42.16V43.925c14.965 0 29.277-.22 43.578.102 6.272.14 12.693.71 18.745 2.264 16.98 4.356 25.74 17.026 24.565 34.44-.894 13.243-7.428 21.372-23.02 28.047l29.19 48.008H134.98c-7.978-14.616-16.098-29.49-24.266-44.458h-8.694v44.458H32.206zm69.767-65.03c8.372.24 16.34.83 24.032-1.815 5.438-1.87 8.124-5.945 7.958-11.332-.156-5.046-3.123-8.854-8.62-10.223-7.636-1.9-15.405-1.27-23.37-1.063v24.43z"/><path fill-rule="evenodd" clip-rule="evenodd" fill="#e3b932" d="M101.973 91.753V67.32c7.965-.204 15.734-.836 23.37 1.064 5.497 1.37 8.464 5.177 8.62 10.223.166 5.387-2.52 9.46-7.958 11.33-7.692 2.647-15.66 2.057-24.032 1.816z"/></svg>
        <svg class="logo -footer back" width="200" height="200" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h200v200H0V0z" fill="#e3b932"/><path d="M158.308 118.845l-20.244 20.34L100 101.304l-38.064 37.883-20.244-20.34L100 60.813l58.308 58.03z" fill="#fff"/></g></svg>
      </div>
    </a>
  </footer>

    </div>
  </div>

  <script src="/assets/js/bundle-fe3d4463be71401c260e04f488e00ce4.js"></script>
  </body>
</html>

