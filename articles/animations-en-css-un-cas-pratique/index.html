<!DOCTYPE html>
<html lang="fr" class="no-js">

<head>
  <meta charset="UTF-8" />
  <title>Ronan Levesque &ndash; Animations en CSS : un cas pratique</title>
  <meta name="description" content="Exemple d&#39;animation d&#39;une bannière grâce à CSS3" />
  <meta name="author" content="Ronan Levesque" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Ronan Levesque" />
  <meta property="og:title" content="Animations en CSS : un cas pratique" />
  <meta property="og:description" content="Exemple d&#39;animation d&#39;une bannière grâce à CSS3" />
  <link rel="dns-prefetch" href="//www.google-analytics.com" />
  <link rel="dns-prefetch" href="//fonts.googleapis.com" />
  <link rel="stylesheet" href="/assets/css/main-a6e1284a.css" />
  <link href="https://fonts.googleapis.com/css?family=Dosis:700%7CRoboto+Mono:400,700%7CRoboto:400,400i,700" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
  <link rel="manifest" href="/favicons/manifest.json">
  <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#0d2c54">
  <link rel="shortcut icon" href="/favicons/favicon.ico">
  <meta name="msapplication-config" content="/favicons/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
  <script>
    document.documentElement.className = document.documentElement.className.replace(/(\s|^)no-js(\s|$)/, '$1js$2');
    if (localStorage.getItem('fontsLoaded')) { document.documentElement.className += ' fonts-loaded'; }
  </script>
</head>

<body>


<div class="Wrapper">
  <header class="MainHeader">
  <a href="/" class="MainHeader-logo">
    <svg class="Logo" viewBox="0 0 136 114" xmlns="http://www.w3.org/2000/svg"><title>Logo Ronan Levesque</title><path d="M.206 113.784V87.542h42.16V.925c14.965 0 29.277-.22 43.578.102 6.272.14 12.693.71 18.745 2.264 16.98 4.356 25.74 17.026 24.565 34.44-.894 13.243-7.428 21.372-23.02 28.047l29.19 48.008H102.98c-7.978-14.616-16.098-29.49-24.266-44.458h-8.694v44.458H.206zm69.767-65.03c8.372.24 16.34.83 24.032-1.815 5.438-1.87 8.124-5.945 7.958-11.332-.156-5.046-3.123-8.854-8.62-10.223-7.636-1.9-15.405-1.27-23.37-1.063v24.43z" fill="#2AFC98" fill-rule="evenodd"/></svg>
  </a>
  <nav class="NavBar">
    <ul class="NavBar-list">
      <li class="NavBar-item">
        <a href="/articles/" class="NavBar-link -selected">Articles</a>
      </li>
      <li class="NavBar-item">
        <a href="/projets/" class="NavBar-link">Projets</a>
      </li>
      <li class="NavBar-item">
        <a href="/a-propos/" class="NavBar-link">À propos</a>
      </li>
    </ul>
  </nav>
</header>

  <main>
    <article class="Article">
      <header class="Article-header">
        <time class="Article-date">7 mai 2013</time>
        <h1 class="Article-title">Animations en CSS : un cas pratique</h1>
      </header>
      <div class="Article-content  -articlePage">
        <p>J&rsquo;avais posté il y a quelques temps un bref <a href="http://ronanlevesque.fr/les-animations-en-css/">tutoriel</a> sur les animations en CSS. Depuis je n&rsquo;avais pas vraiment creusé la question, mais en refaisant le site récemment j&rsquo;ai décidé d&rsquo;ajouter un peu de vie dans la bannière, en faisant bouger quelques-uns des éléments du paysage (nuage, fumée de l&rsquo;usine, drapeau et montgolfière). L&rsquo;idée ici est de montrer comment ça fonctionne, concrètement.</p>

<hr />

<p>Attention, comme pour le tuto précédent, dans les exemples qui suivent je n&rsquo;ai rien préfixé pour plus de simplicité.</p>

<p class="info">Mise à jour (04/06/2013)&nbsp;: j'ai changé le header de mon site depuis, mais j'ai laissé un <a href="/old/old5/page.html">exemple</a> en ligne.</p>

<h2>Les animations en détail</h2>

<h3>Les nuages</h3>

<p>La première des animations sur laquelle j&rsquo;ai travaillé était de faire bouger les nuages comme si ils étaient mûs par un vent d&rsquo;ouest (de gauche). Il existe deux méthodes pour faire bouger des éléments&nbsp;:</p>

<ol>
<li>Avec les propriétés <code>translate()</code>, <code>translateX()</code> et <code>translateY()</code></li>
<li>En utilisant <code>position:absolute</code> et <code>left</code>, <code>right</code>, <code>top</code>, <code>bottom</code>.</li>
</ol>

<p>Il semblerait que la première solution soit celle à privilégier pour des <a href="http://paulirish.com/2012/why-moving-elements-with-translate-is-better-than-posabs-topleft/">soucis de performance&nbsp;<sup>EN</sup></a>. Le hic, c&rsquo;est que <code>translate()</code> ne bouge l&rsquo;élément que par rapport à sa position originale. Ça me posait un souci car dans ce cas, impossible d&rsquo;avoir un contrôle précis de la position de l&rsquo;élément par rapport à la fenêtre du navigateur. J&rsquo;ai donc eu recours à la deuxième solution, en utilisant le <code>@keyframes</code> suivant&nbsp;:</p>

<pre><code class="css">@keyframes nuage1 {
  from {left: -200px;}
  to {left: 100%;}
}</code></pre>

<p>De cette façon, mon nuage apparaîtra à chaque fois à 200px du bord gauche de ma fenêtre et se repositionnera bien après être arrivé à 100%. J&rsquo;ai ensuite attribué plusieurs vitesses à chacun de mes nuages pour leur donner un effet plus réaliste, par exemple&nbsp;:</p>

<pre><code class="css">.nuage1 {
  animation: nuage1 32s linear infinite;
}</code></pre>

<p>Les animations des nuages saccadent légèrement sur Chrome, mais sur Firefox et IE10 c&rsquo;est plutôt fluide, d&rsquo;après ce que j&rsquo;ai testé.</p>

<p class="info">Mise à jour (11/05/2013)&nbsp;: en testant le site sur iPad je me suis rendu compte que l'animation ne marchait pas du tout&nbsp;: les nuages restent collés à 100% de leur position, sans bouger. Je creuserai la question plus tard, en attendant j'ai désactivé leurs animations.</p>

<h3>La montgolfière</h3>

<p>Là, contrairement aux nuages, la montgolfière ne bouge que par rapport à sa position d&rsquo;origine, l&rsquo;idée étant de lui donner un léger effet &ldquo;flottant&rdquo; de haut en bas. J&rsquo;ai donc pu utiliser <code>translateY()</code> pour arriver à ce résultat&nbsp;:</p>

<pre><code class="css">@keyframes montgolfiere {
  50% {transform: translateY(10px);}
}</code></pre>

<p>A noter qu&rsquo;un simple ligne revient ici au même résultat que si l&rsquo;on avait défini trois étapes à 0, 50 et 100% de notre <code>@keyframes</code>, l&rsquo;idée étant de faire revenir l&rsquo;élément à sa position de départ.</p>

<h3>La fumée</h3>

<p>Ici, même principe que pour l&rsquo;animation de la montgolfière&nbsp;: la fumée se déplacera à chaque fois par rapport à sa position initiale. J&rsquo;ai également ajouté un effet d&rsquo;opacité, pour la rendre un peu plus réaliste. Le code est le suivant&nbsp;:</p>

<pre><code class="css">@keyframes fumee {
  from {transform: translate(0px, 0px); opacity: 0;}
  50% {transform: translate(7px, -7px); opacity: 1;}
  to {transform: translate(20px, -20px); opacity: 0;}
}</code></pre>

<p>Arrivée à 100% de l&rsquo;animation, la fumée repartira de son point de départ.</p>

<h3>Le drapeau</h3>

<p>Pour donner l&rsquo;impression que le drapeau flotte au vent, c&rsquo;est plutôt simple&nbsp;: il suffit de changer sa <code>width</code> dans le temps, de la manière suivante&nbsp;:</p>

<pre><code class="css">@keyframes flag {
  50% {width: 4px;}
}</code></pre>

<p>Le drapeau passera de 7 à 4px en boucle, donnant ainsi l&rsquo;impression qu&rsquo;il bouge.</p>

<h2>Problèmes rencontrés</h2>

<p>Les animations n&rsquo;ont rien de sorcier, elles sont simples à utiliser une fois qu&rsquo;on a saisi le concept de départ. J&rsquo;ai juste rencontré deux problèmes lors de leur conception&hellip;</p>

<p>Tout d&rsquo;abord, sur Firefox et IE10, les animations de la fumée et de la montgolfière sont légèrement saccadées, contrairement à Chrome. En fait ce dernier semble lisser les animations d&rsquo;un pixel à un autre, ce qui rend l&rsquo;image légèrement floue mais donne un meilleur rendu final. Les deux autres navigateurs déplacent l&rsquo;image pixel par pixel, le rendu est légèrement moins esthétique à mon goût&hellip; Mais à ma connaissance on ne peut malheureusement pas y faire grand chose.</p>

<p>Ensuite, après avoir bouclé mes animations, j&rsquo;ai testé tout ça sur Firefox (niquel), puis sur Chrome (niquel), et arrivé sur IE10&nbsp;: rien ne se passe. Un peu bizarre, IE10 gère normalement très bien les animations, et ce sans avoir besoin de les préfixer. Après avoir vérifié et revérifié la syntaxe, fait quelques tests supplémentaires, et m&rsquo;être arraché un ou deux cheveux, j&rsquo;ai trouvé la solution&nbsp;: en fait j&rsquo;ai créé deux feuilles de styles pour mon site, style.css et expand.css. La deuxième utilise un <code>media</code> avec une <code>(min-width: 35em)</code>. Mes <code>@keyframes</code> étaient situées dans expand.css&nbsp;: dès que je les ai déplacés dans style.css, les animations se sont remises à marcher. Je n&rsquo;ai aucune idée de la raison pour laquelle IE10 bloque les animations lorsque celles-ci sont contenues dans une feuille de style d&rsquo;une taille spécifique, mais au moins je sais comment corriger ça maintenant&nbsp;:)</p>

<h2>Fallbacks possibles</h2>

<p>J&rsquo;ai utilisé un fallback simple pour que le rendu reste agréable sur les navigateurs ne supportant pas les <code>@keyframes</code>&nbsp;: les nuages, fumée et montgolfière sont définis dès le départ en position absolue. Ils seront simplement fixes.</p>

      </div>
    </article>
  </main>
</div>


  <script src="/assets/js/bundle-3f973440.js"></script>
</body>

</html>

